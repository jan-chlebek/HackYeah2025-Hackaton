# High Contrast Mode - Fixed Component Table Headers and Hover

**Date:** 2025-10-05  
**Branch:** FrontendNG  
**Time:** 03:57:40

## User Request

"This component still have light table headers. Can you implement the same styling (yellow hover with dark text) on menu items?"

## Problem Analysis

Component-scoped CSS in Angular has higher specificity than global styles. The library-list and messages-list components had their own `::ng-deep` styles that were overriding the global high contrast mode rules, causing:

1. **Table headers** - showing light/gradient backgrounds instead of black
2. **Table rows** - not getting yellow background on hover
3. **Table cells** - text not turning black on hover

### Root Cause

The components had these styles that were overriding global high contrast:

```css
:host ::ng-deep .p-datatable .p-datatable-thead > tr > th {
  background: linear-gradient(to bottom, #f8f9fa, #f0f2f5);
  color: var(--uknf-primary-blue);
  /* ... more styles ... */
}

:host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover {
  background: linear-gradient(to right, #f0f7ff, #e6f3ff);
  /* ... more styles ... */
}
```

The `:host ::ng-deep` selector from component styles has higher specificity than the global `html.high-contrast` selector.

## Solution

Added component-specific high contrast overrides using `html.high-contrast :host ::ng-deep` which has even higher specificity and properly overrides the component's default styles.

## Files Modified

### 1. `frontend/uknf-project/src/app/features/library/library-list/library-list.component.css`

Added comprehensive high contrast styles for table headers and hover states:

```css
/* High Contrast - Table Headers */
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-thead > tr > th {
  background: #000000 !important;
  color: #FFFF00 !important;
  border-bottom: 2px solid #FFFF00 !important;
  border-right: 1px solid #FFFF00 !important;
}

html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr > td {
  background-color: #000000 !important;
  color: #FFFF00 !important;
  border-bottom: 1px solid #FFFF00 !important;
  border-right: 1px solid #FFFF00 !important;
}

/* High Contrast - Table Row Hover */
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover {
  background: #FFFF00 !important;
  transform: none;
  box-shadow: none;
}

html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover > td {
  background-color: #FFFF00 !important;
  color: #000000 !important;
}

html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover .file-name,
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover * {
  color: #000000 !important;
}

/* High Contrast - Even Rows */
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:nth-child(even) {
  background-color: #000000 !important;
}

html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:nth-child(even):hover {
  background: #FFFF00 !important;
}
```

### 2. `frontend/uknf-project/src/app/features/messages/messages-list/messages-list.component.css`

Added identical high contrast styles for the messages table:

```css
/* High Contrast - Table Headers */
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-thead > tr > th {
  background: #000000 !important;
  color: #FFFF00 !important;
  border-bottom: 2px solid #FFFF00 !important;
  border-right: 1px solid #FFFF00 !important;
}

/* ... same pattern as library-list ... */

html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover .message-subject,
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover .status-badge,
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover .priority-badge,
html.high-contrast :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover * {
  color: #000000 !important;
}
```

## CSS Specificity Hierarchy

Understanding Angular component style specificity:

1. **Lowest:** Global styles
   ```css
   html.high-contrast .p-datatable thead th { ... }
   ```

2. **Medium:** Component default styles
   ```css
   :host ::ng-deep .p-datatable thead th { ... }
   ```

3. **Highest:** Component high contrast overrides
   ```css
   html.high-contrast :host ::ng-deep .p-datatable thead th { ... }
   ```

The solution uses the highest specificity level to ensure high contrast mode properly overrides component defaults.

## Visual Behavior

### Normal Mode
- **Table Headers:** Light gradient background with blue text
- **Table Rows:** Light blue gradient on hover
- **Even Rows:** Alternating light gray background

### High Contrast Mode (Fixed)
- **Table Headers:** ✅ Black background (#000000) with yellow text (#FFFF00)
- **Table Cells:** ✅ Black background with yellow text
- **Row Hover:** ✅ Yellow background (#FFFF00) with black text (#000000)
- **All Child Elements:** ✅ Text and icons turn black on hover

## Affected Components

Both table components now have proper high contrast mode:

1. **Library List** (`/biblioteka`)
   - File repository table
   - File name, size, date columns
   - Action buttons in rows

2. **Messages List** (`/wiadomosci`)
   - Messages inbox table
   - Subject, status, priority columns
   - Badge elements

## Testing Checklist

- [ ] Toggle high contrast mode on
- [ ] Navigate to Library page (`/biblioteka`)
- [ ] Verify table headers have black background with yellow text
- [ ] Hover over table rows - should turn yellow with black text
- [ ] Verify file names and all text turn black on hover
- [ ] Navigate to Messages page (`/wiadomosci`)
- [ ] Verify table headers have black background with yellow text
- [ ] Hover over message rows - should turn yellow with black text
- [ ] Verify status badges and priority labels turn black on hover
- [ ] Check even rows (striped) maintain black background
- [ ] Toggle high contrast mode off and verify normal styling returns

## Key Learnings

### Angular Component Scoping
- Component styles with `::ng-deep` have higher specificity than global styles
- Must use `html.high-contrast :host ::ng-deep` to override component defaults
- The `!important` flag helps ensure overrides take precedence

### Wildcard Selectors
Using `* { color: #000000 !important; }` on hover ensures ALL child elements (badges, icons, spans, etc.) get the proper black text color.

### Transform and Box-Shadow
Disabled hover animations in high contrast mode:
```css
transform: none;
box-shadow: none;
```
This prevents visual distractions and keeps focus on the high contrast colors.

## Related Files

This pattern should be applied to any other component with tables:
- Dashboard component (if it has tables)
- Reports component
- Cases component
- Any future components with `p-table` or `p-datatable`

## Design Rationale

Component-specific high contrast styles ensure:
1. **Consistency:** All tables look the same in high contrast mode
2. **Accessibility:** WCAG AAA compliant (19.56:1 contrast ratio)
3. **Maintainability:** Each component manages its own high contrast overrides
4. **Flexibility:** Components can have different normal styles but uniform high contrast

The yellow-on-black color scheme provides maximum visibility for users with visual impairments while maintaining a consistent experience across all table components in the application.
