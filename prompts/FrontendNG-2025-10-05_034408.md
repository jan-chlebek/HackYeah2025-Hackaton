# High Contrast Mode - Fix Button Text Visibility in Active State

**Date:** 2025-10-05  
**Branch:** FrontendNG  
**Time:** 03:44:08

## User Prompt

"On header font size button dark colour is not visible on the font"

## Problem

When buttons were in active/selected state (yellow background), the text inside them (labels, spans) was still being rendered in yellow due to the global typography rule that sets all `label`, `span`, `p`, and heading elements to yellow color. This made the text invisible on the yellow background.

**Example:**
- Active button: Yellow background (#FFFF00)
- Button text (span/label): Yellow (#FFFF00) ❌ Not visible!

## Root Cause

The global typography rule had higher specificity in some cases:

```css
html.high-contrast label,
html.high-contrast span,
html.high-contrast p,
html.high-contrast h1,
html.high-contrast h2,
html.high-contrast h3,
html.high-contrast h4,
html.high-contrast h5,
html.high-contrast h6 {
  color: #FFFF00 !important;
}
```

This rule was overriding the button text color even when the button had a yellow background.

## Solution

Added two layers of protection to ensure text inside selected/active elements with yellow backgrounds is always black:

### 1. Direct Child Selector Override

Added wildcard selectors for all children of active buttons:

```css
html.high-contrast button:active *,
html.high-contrast .p-button:active *,
html.high-contrast button.p-button-active *,
html.high-contrast .p-button.p-button-active *,
html.high-contrast button.active *,
html.high-contrast .p-button.active *,
html.high-contrast button[aria-selected="true"] *,
html.high-contrast .p-button[aria-selected="true"] * {
  color: #000000 !important;
}

html.high-contrast .p-button:enabled:active * {
  color: #000000 !important;
}
```

### 2. Typography-Specific Override

Added explicit overrides for all typography elements (label, span, p) inside any selected/highlighted component:

```css
/* Override typography color for selected/active elements with yellow background */
html.high-contrast button:active label,
html.high-contrast button:active span,
html.high-contrast button.active label,
html.high-contrast button.active span,
html.high-contrast button[aria-selected="true"] label,
html.high-contrast button[aria-selected="true"] span,
html.high-contrast .p-button:active label,
html.high-contrast .p-button:active span,
html.high-contrast .p-button.active label,
html.high-contrast .p-button.active span,
html.high-contrast .p-button[aria-selected="true"] label,
html.high-contrast .p-button[aria-selected="true"] span,
html.high-contrast .p-datatable-tbody > tr.p-highlight label,
html.high-contrast .p-datatable-tbody > tr.p-highlight span,
html.high-contrast .p-datatable-tbody > tr.p-highlight p,
html.high-contrast .p-dropdown-item.p-highlight label,
html.high-contrast .p-dropdown-item.p-highlight span,
html.high-contrast .p-dropdown-item.p-selected label,
html.high-contrast .p-dropdown-item.p-selected span,
html.high-contrast .p-select-option.p-highlight label,
html.high-contrast .p-select-option.p-highlight span,
html.high-contrast .p-select-option.p-selected label,
html.high-contrast .p-select-option.p-selected span,
html.high-contrast .p-paginator-page.p-highlight label,
html.high-contrast .p-paginator-page.p-highlight span,
html.high-contrast .p-tabview-nav-link.p-highlight label,
html.high-contrast .p-tabview-nav-link.p-highlight span,
html.high-contrast .p-tabview-nav-link[aria-selected="true"] label,
html.high-contrast .p-tabview-nav-link[aria-selected="true"] span,
html.high-contrast .p-menuitem.p-highlight label,
html.high-contrast .p-menuitem.p-highlight span,
html.high-contrast .p-datatable .p-sortable-column.p-highlight label,
html.high-contrast .p-datatable .p-sortable-column.p-highlight span {
  color: #000000 !important;
}
```

## Files Modified

### `frontend/uknf-project/src/styles.css`

**Changes:**

1. Added wildcard child selectors for active buttons (lines after button active states)
2. Added comprehensive typography overrides for all selected/highlighted elements (after global typography rules)

## Components Covered

This fix ensures black text on yellow background for:

- ✅ **Buttons** (active, selected states)
- ✅ **Table rows** (selected/highlighted)
- ✅ **Dropdown items** (selected)
- ✅ **Select options** (selected)
- ✅ **Paginator pages** (current page)
- ✅ **Tabs** (active tab)
- ✅ **Menu items** (highlighted)
- ✅ **Sortable columns** (active sort)

## Technical Details

### CSS Specificity Strategy

Used multiple approaches to ensure overrides work:
1. **Wildcard selectors** (`*`) to catch all children
2. **Specific element selectors** (label, span, p) for explicit coverage
3. **Multiple state classes** (.p-highlight, .p-selected, :active, [aria-selected])
4. **Important flag** (!important) to override global rules

### Order of Rules

Placed the typography overrides **after** the global typography rules to ensure higher cascade priority:

1. Global typography rules (line ~474)
2. Selected element typography overrides (line ~486)

This ensures the more specific rule wins in the CSS cascade.

## Testing Checklist

- [ ] Font size buttons in header show black text when selected
- [ ] All active buttons show black text on yellow background
- [ ] Selected table rows show black text
- [ ] Selected dropdown items show black text
- [ ] Active paginator page shows black number
- [ ] Active tab shows black text
- [ ] No yellow-on-yellow text combinations exist

## Browser Compatibility

Standard CSS selectors and properties used, compatible with:
- Chrome/Edge (Chromium-based)
- Firefox
- Safari
- Opera

## Visual Result

**Before:**
- Active button: Yellow background + Yellow text = ❌ Invisible text

**After:**
- Active button: Yellow background + Black text = ✅ Highly visible text
- Contrast ratio: 19.56:1 (WCAG AAA compliant)

## Future Improvements

If additional yellow-on-yellow text issues are discovered:
1. Inspect the element to identify its container selector
2. Add the selector to the typography override rule
3. Include all relevant state classes (.p-highlight, .p-selected, etc.)
4. Test with all interactive states (hover, active, selected)
