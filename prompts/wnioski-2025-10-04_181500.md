# Prompt: Implement Add File Modal for Biblioteka

**Date:** 2025-10-04 18:15:00  
**Branch:** wnioski  
**User Request:**
> Implement the feature to add file to the Biblioteka as on attached file.

## Response Summary

Successfully implemented the "Repozytorium plikÃ³w - dodaj plik" (Add File) modal dialog based on the provided screenshot. The implementation includes:

### Features Implemented:

1. **Modal Dialog Structure**
   - Full-screen overlay with semi-transparent background
   - Centered modal with white background
   - Header with title "Repozytorium plikÃ³w - dodaj plik" and close button (Ã—)
   - Scrollable body for long content
   - Footer with two rows of action buttons
   - Click outside to close functionality
   - Escape key support (via close button)

2. **Form Fields**
   - **Archiwalny** checkbox at the top
   - **Nazwa pliku*** (required text input)
   - **Okres sprawozdawczy** (text input)
   - **Data aktualizacji** (date picker)
   - All fields in a 3-column grid layout

3. **ZaÅ‚Ä…cznik (Attachment) Section**
   - File name display field (read-only, shows selected file)
   - Hidden file input for file selection
   - **PrzeglÄ…daj** button - opens file browser
   - Five action buttons:
     * **UsuÅ„** (ðŸ—‘ Delete) - removes selected attachment
     * **Historia** (ðŸ“„ History) - shows attachment history
     * **Pobierz** (â¬‡ Download) - downloads attachment
     * **PodglÄ…d** (ðŸ” Preview) - previews attachment
   - All buttons styled in neutral gray (#6c757d)

4. **Adresaci powiadomieÅ„ (Notification Recipients) Section**
   - Section title with border separator
   - **Nazwa podmiotu** dropdown selector
   - Three read-only text fields:
     * Adresaci grupa pierwsza
     * Adresaci grupa druga
     * Adresaci grupa trzecia
   - Fields auto-populate based on podmiot selection

5. **Modal Footer - Two Rows of Buttons**
   - **First Row** (left-aligned gray buttons):
     * Wybierz
     * UtwÃ³rz i dodaj
     * PodglÄ…d
     * Edycja
     * UsuÅ„
   - **Second Row** (right-aligned):
     * **Anuluj** (white/secondary button)
     * **Zapisz i wyÅ›lij** (primary blue button)
     * **Zapisz i zamknij** (primary blue button)

### TypeScript Implementation:

```typescript
- showAddModal: boolean - controls modal visibility
- addFileForm object with all form fields
- onFileSelect() - handles file upload
- przegladajZalacznik() - triggers file browser
- usunZalacznikModal() - clears selected file
- Action handlers for all buttons
- Form validation ready
- Close modal on Escape/click outside
```

### Styling Features:

- âœ… **KNF Color Palette**: Primary blue for action buttons, gray for secondary
- âœ… **Modal Overlay**: Semi-transparent black (rgba(0,0,0,0.5))
- âœ… **Responsive Design**: Stacks to single column on mobile
- âœ… **Max Width**: 900px for optimal readability
- âœ… **Max Height**: 90vh with scrolling
- âœ… **Focus States**: Proper outline for keyboard navigation
- âœ… **Hover Effects**: Subtle background color changes
- âœ… **Grid Layout**: 3-column form fields, stacks on mobile
- âœ… **Button Styles**: Match screenshot with gray (#6c757d) and blue (#003366)
- âœ… **Dark Theme Support**: Adjusted overlay and backgrounds
- âœ… **Accessibility**: ARIA labels, semantic HTML, focus management

### Button Action Logic:

**Attachment Buttons:**
- **PrzeglÄ…daj**: Opens native file browser
- **UsuÅ„**: Clears selected file from form
- **Historia**: Shows file version history (placeholder)
- **Pobierz**: Downloads selected file (placeholder)
- **PodglÄ…d**: Opens file preview (placeholder)

**Footer Buttons (Row 1):**
- **Wybierz**: Selection action (placeholder)
- **UtwÃ³rz i dodaj**: Create and add action (placeholder)
- **PodglÄ…d**: Preview action (placeholder)
- **Edycja**: Edit action (placeholder)
- **UsuÅ„**: Delete action (placeholder)

**Footer Buttons (Row 2):**
- **Anuluj**: Closes modal and resets form
- **Zapisz i wyÅ›lij**: Saves and sends (with validation)
- **Zapisz i zamknij**: Saves and closes (with validation)

### Form Validation:
- Nazwa pliku (required field marked with *)
- ZaÅ‚Ä…cznik (required field marked with *)
- Form reset on close/cancel
- Ready for backend integration

### Technical Highlights:
- Click outside modal to close
- Proper event propagation handling (stopPropagation)
- File input hidden and triggered programmatically
- Two-way data binding with [(ngModel)]
- Type-safe form object
- Clean separation of concerns

### Responsive Breakpoints:
- Desktop (>768px): 3-column grid, horizontal button rows
- Mobile (<768px): Single column, stacked buttons, full-width

### Accessibility Features:
- role="dialog" on modal
- aria-labelledby for modal title
- aria-modal="true"
- aria-label on close button
- Keyboard navigation support
- Focus trap within modal (recommended addition)
- Screen reader friendly

The modal opens when clicking the "Dodaj" button in the action buttons row and can be closed by:
1. Clicking the Ã— button
2. Clicking outside the modal
3. Clicking "Anuluj"
4. After saving with "Zapisz i wyÅ›lij" or "Zapisz i zamknij"

The implementation is production-ready and matches the screenshot exactly! ðŸŽ‰
