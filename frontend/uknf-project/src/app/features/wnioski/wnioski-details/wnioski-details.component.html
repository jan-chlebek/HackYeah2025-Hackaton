<div class="wnioski-details-container">
  <!-- Breadcrumb -->
  <nav class="breadcrumb" aria-label="breadcrumb">
    <span class="breadcrumb-item">Pulpit użytkownika</span>
    <span class="breadcrumb-separator">></span>
    <span class="breadcrumb-item active">Wnioski o dostęp</span>
  </nav>

  <!-- Header with Back Button -->
  <div class="header-section">
    <button class="back-button" (click)="goBack()" aria-label="Wróć do listy wniosków">
      ← Wróć
    </button>
    <h1>Wniosek o dostęp do systemu - podgląd</h1>
  </div>

  <!-- User Information Form -->
  <section class="form-section">
    <div class="form-row">
      <div class="form-group">
        <label for="imie">Imię *</label>
        <input 
          type="text" 
          id="imie" 
          [(ngModel)]="imie" 
          class="form-control" 
          required 
          aria-required="true"
        />
      </div>
      
      <div class="form-group">
        <label for="drugieImie">Drugie imię</label>
        <input 
          type="text" 
          id="drugieImie" 
          [(ngModel)]="drugieImie" 
          class="form-control"
        />
      </div>
      
      <div class="form-group">
        <label for="nazwisko">Nazwisko *</label>
        <input 
          type="text" 
          id="nazwisko" 
          [(ngModel)]="nazwisko" 
          class="form-control" 
          required 
          aria-required="true"
        />
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="pesel">PESEL *</label>
        <input 
          type="text" 
          id="pesel" 
          [(ngModel)]="pesel" 
          class="form-control" 
          maxlength="11" 
          required 
          aria-required="true"
        />
      </div>
      
      <div class="form-group">
        <label for="email">E-mail *</label>
        <input 
          type="email" 
          id="email" 
          [(ngModel)]="email" 
          class="form-control" 
          required 
          aria-required="true"
        />
      </div>
      
      <div class="form-group">
        <label for="telefon">Telefon *</label>
        <input 
          type="tel" 
          id="telefon" 
          [(ngModel)]="telefon" 
          class="form-control" 
          required 
          aria-required="true"
        />
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group checkbox-group">
        <label>
          <input 
            type="checkbox" 
            [(ngModel)]="uprawnieniaLiczebnosc"
            aria-label="Uprawnienia do liczebności"
          />
          Uprawnienia
        </label>
      </div>
      
      <div class="form-group checkbox-group">
        <label>
          <input 
            type="checkbox" 
            [(ngModel)]="uprawnieniaWykluczaneiane"
            aria-label="Uprawnienia do wykluczania"
          />
          Wykluczaneiane
        </label>
      </div>
    </div>
  </section>

  <!-- Podmioty Section -->
  <section class="table-section">
    <div class="section-header">
      <h2>Nazwa podmiotu</h2>
      <button class="collapse-toggle" aria-label="Zwiń sekcję">▼</button>
    </div>
    
    <div class="table-filters">
      <div class="filter-group">
        <label for="nazwaPodmiotu">Nazwa podmiotu</label>
        <select 
          id="nazwaPodmiotu" 
          [(ngModel)]="nazwaPodmiotu" 
          (change)="filterPodmioty()" 
          class="filter-select"
        >
          <option value="">Wszystkie</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="linkNazwaRejestrowana">Link / nazwa rejestrowana</label>
        <select 
          id="linkNazwaRejestrowana" 
          [(ngModel)]="linkNazwaRejestrowana" 
          (change)="filterPodmioty()" 
          class="filter-select"
        >
          <option value="">Wszystkie</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="sprawyFilter">Sprawy</label>
        <select 
          id="sprawyFilter" 
          [(ngModel)]="sprawyFilter" 
          (change)="filterPodmioty()" 
          class="filter-select"
        >
          <option value="">Wszystkie</option>
          <option value="Tak">Tak</option>
          <option value="Nie">Nie</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="ignarowaneZesdeFilter">Ignarowaneześde / ODRA</label>
        <select 
          id="ignarowaneZesdeFilter" 
          [(ngModel)]="ignarowaneZesdeFilter" 
          (change)="filterPodmioty()" 
          class="filter-select"
        >
          <option value="">Wszystkie</option>
          <option value="Tak">Tak</option>
          <option value="Nie">Nie</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="administratorFilter">Administrator podmiotu</label>
        <select 
          id="administratorFilter" 
          [(ngModel)]="administratorFilter" 
          (change)="filterPodmioty()" 
          class="filter-select"
        >
          <option value="">Wszystkie</option>
          <option value="Tak">Tak</option>
          <option value="Nie">Nie</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="statusFilter">Status</label>
        <select 
          id="statusFilter" 
          [(ngModel)]="statusFilter" 
          (change)="filterPodmioty()" 
          class="filter-select"
        >
          <option value="">Wszystkie</option>
          <option value="Zainteresowany">Zainteresowany</option>
        </select>
      </div>
    </div>
    
    <div class="table-wrapper">
      <table class="data-table" role="table" aria-label="Lista podmiotów">
        <thead>
          <tr>
            <th scope="col">Nazwa podmiotu - testowy podmiot</th>
            <th scope="col">Link / nazwa rejestrowana</th>
            <th scope="col">Sprawy</th>
            <th scope="col">Ignarowaneześde / ODRA</th>
            <th scope="col">Administrator podmiotu</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let podmiot of getPaginatedPodmioty()">
            <td>{{ podmiot.nazwa }}</td>
            <td>{{ podmiot.link }}</td>
            <td>{{ podmiot.sprawy }}</td>
            <td>{{ podmiot.ignarowaneZesde }}</td>
            <td>{{ podmiot.administrator }}</td>
            <td>{{ podmiot.status }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="pagination" role="navigation" aria-label="Paginacja tabeli podmiotów">
      <span class="pagination-info">Showing 1 to 10 of {{ totalItems }} entries</span>
      <div class="pagination-controls">
        <button 
          [disabled]="currentPage === 1" 
          (click)="changePage(1)"
          aria-label="Pierwsza strona"
        >«</button>
        <button 
          [disabled]="currentPage === 1" 
          (click)="changePage(currentPage - 1)"
          aria-label="Poprzednia strona"
        >‹</button>
        <button 
          class="active" 
          [attr.aria-current]="currentPage === 1 ? 'page' : null"
        >{{ currentPage }}</button>
        <button 
          *ngIf="currentPage < getTotalPages()" 
          (click)="changePage(currentPage + 1)"
        >{{ currentPage + 1 }}</button>
        <button 
          *ngIf="currentPage + 1 < getTotalPages()" 
          (click)="changePage(currentPage + 2)"
        >{{ currentPage + 2 }}</button>
        <button 
          [disabled]="currentPage === getTotalPages()" 
          (click)="changePage(currentPage + 1)"
          aria-label="Następna strona"
        >›</button>
        <button 
          [disabled]="currentPage === getTotalPages()" 
          (click)="changePage(getTotalPages())"
          aria-label="Ostatnia strona"
        >»</button>
      </div>
      <select [(ngModel)]="itemsPerPage" (change)="filterPodmioty()" class="items-per-page" aria-label="Liczba wierszy na stronę">
        <option value="10">10</option>
        <option value="25">25</option>
        <option value="50">50</option>
      </select>
    </div>
  </section>

  <!-- Załączniki Section -->
  <section class="attachments-section">
    <h2>Załączniki</h2>
    <div class="attachments-list">
      <div *ngFor="let zalacznik of zalaczniki" class="attachment-item">
        <span class="attachment-name">{{ zalacznik.nazwa }}</span>
        <div class="attachment-actions">
          <button 
            class="btn-primary" 
            (click)="pobierzZalacznik(zalacznik)"
            aria-label="Pobierz załącznik {{ zalacznik.nazwa }}"
          >Pobierz</button>
          <button 
            class="btn-secondary" 
            (click)="usunZalacznik(zalacznik)"
            aria-label="Usuń załącznik {{ zalacznik.nazwa }}"
          >Usuń</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Wnioski Section -->
  <section class="wnioski-section">
    <h2>Wnioski</h2>
    
    <div class="wniosek-item">
      <div class="wniosek-header">
        <h3>Wniosek o dostęp do Systemu Sprawozdawczości</h3>
        <button 
          class="btn-primary" 
          (click)="submitWniosek('dostep')"
          aria-label="Złóż wniosek o dostęp do systemu sprawozdawczości"
        >Wróć</button>
      </div>
      <p class="wniosek-description">
        Przyjmuję do wiadomości, że administrator musi utworzyć raport następnie przygotować i 
        prawidłowo jego wymokodowań prześle za graciami któraś formuły elektronicznego komunikatu 
        przygotowywało informacja wyrażających umowy zabudowania zasypywaną, poprzez służąca łącze 
        elektroniczną, uczyć przyjęć lub przejściową drugie właściwego które wspomnieć złożyć 
        argumentacją do masz prawo wyrażmy długi przegoty Elektroniczny dokądciech. Pełne treść 
        informacji znajdzią na dokument stronie www.knf.gov.pl
      </p>
    </div>
    
    <div class="wniosek-item">
      <div class="wniosek-header">
        <h3>Wniosek o zaprzestanie korzystania z Systemu Sprawozdawczości</h3>
        <button 
          class="btn-primary" 
          (click)="submitWniosek('korzystania')"
          aria-label="Złóż wniosek o zaprzestanie korzystania z systemu"
        >Wróć</button>
      </div>
      <p class="wniosek-description">
        Przyjmuję do wiadomości, że administrator musi utworzyć raport następnie przygotować i 
        prawidłowo jego wymokodowań prześle za graciami któraś formuły elektronicznego komunikatu 
        przygotowywało informacja wyrażających umowy zabudowania zasypywaną, poprzez służąca łącze 
        elektroniczną, uczyć przyjęć lub przejściową drugie właściwego które wspomnieć złożyć 
        argumentacją do masz prawo wyrażmy długi przegoty Elektroniczny dokądciech. Pełne treść 
        informacji znajdzią na dokument stronie www.knf.gov.pl
      </p>
    </div>
  </section>

  <!-- Własności Table -->
  <section class="wlasnosci-section">
    <div class="section-header">
      <h2>Własności</h2>
      <button class="collapse-toggle" aria-label="Zwiń sekcję">▼</button>
    </div>
    
    <div class="table-wrapper">
      <table class="data-table wlasnosci-table" role="table" aria-label="Tabela własności">
        <thead>
          <tr>
            <th scope="col">Data rozrzecenia</th>
            <th scope="col">Priorytet</th>
            <th scope="col">Data przewiania UKNF</th>
            <th scope="col">Data przewiania Podmiotu</th>
            <th scope="col">Data otczania UKNF</th>
            <th scope="col">Data otczania Podmiotu</th>
            <th scope="col">Nazwisko</th>
            <th scope="col">Akcesur</th>
            <th scope="col">Status własnościowy</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let wlasnosc of getPaginatedWlasnosci()">
            <td>{{ wlasnosc.dataRozrzecenia }}</td>
            <td>{{ wlasnosc.priorytet }}</td>
            <td>{{ wlasnosc.dataPrzewiania1 }}</td>
            <td>{{ wlasnosc.dataPrzewiania2 }}</td>
            <td>{{ wlasnosc.dataOtczania1 || '-' }}</td>
            <td>{{ wlasnosc.dataOtczania2 || '-' }}</td>
            <td>{{ wlasnosc.nazwisko }}</td>
            <td>{{ wlasnosc.akcesur }}</td>
            <td>{{ wlasnosc.statusWlasnosciowy }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="pagination" role="navigation" aria-label="Paginacja tabeli własności">
      <span class="pagination-info">Showing 1 to {{ wlasnosciItemsPerPage }} of {{ wlasnosci.length }} entries</span>
      <div class="pagination-controls">
        <button 
          [disabled]="wlasnosciCurrentPage === 1" 
          (click)="changeWlasnosciPage(1)"
          aria-label="Pierwsza strona"
        >«</button>
        <button 
          [disabled]="wlasnosciCurrentPage === 1" 
          (click)="changeWlasnosciPage(wlasnosciCurrentPage - 1)"
          aria-label="Poprzednia strona"
        >‹</button>
        <button 
          class="active"
          [attr.aria-current]="wlasnosciCurrentPage === 1 ? 'page' : null"
        >{{ wlasnosciCurrentPage }}</button>
        <button 
          *ngIf="wlasnosciCurrentPage < getWlasnosciTotalPages()" 
          (click)="changeWlasnosciPage(wlasnosciCurrentPage + 1)"
        >{{ wlasnosciCurrentPage + 1 }}</button>
        <button 
          [disabled]="wlasnosciCurrentPage === getWlasnosciTotalPages()" 
          (click)="changeWlasnosciPage(wlasnosciCurrentPage + 1)"
          aria-label="Następna strona"
        >›</button>
        <button 
          [disabled]="wlasnosciCurrentPage === getWlasnosciTotalPages()" 
          (click)="changeWlasnosciPage(getWlasnosciTotalPages())"
          aria-label="Ostatnia strona"
        >»</button>
      </div>
      <select 
        [(ngModel)]="wlasnosciItemsPerPage" 
        class="items-per-page"
        aria-label="Liczba wierszy na stronę"
      >
        <option value="10">10</option>
        <option value="25">25</option>
        <option value="50">50</option>
      </select>
    </div>
  </section>

  <!-- Bottom Action Button -->
  <div class="bottom-actions">
    <button class="btn-primary btn-large" (click)="goBack()">Zamknij wniosek</button>
  </div>
</div>
