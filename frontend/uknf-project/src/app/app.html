<!-- Header - Always visible, but simplified on auth routes -->
<header class="app-header">
  <div class="header-left">
    @if (!isAuthRoute()) {
    <button class="menu-toggle" (click)="toggleMenu()" aria-label="Toggle menu">
      <span class="menu-icon">☰</span>
    </button>
    }
    <div class="logo-container">
      <div class="logo">
        <img src="assets/images/uknf-logo.png" alt="UKNF - Urząd Komisji Nadzoru Finansowego" class="logo-image">
      </div>
    </div>
    <h1 class="app-title">System Komunikacji z Podmiotami</h1>
  </div>
  
  <div class="header-right">
    @if (!isAuthRoute()) {
    <div class="session-timer">
      <span class="timer-icon icon-clock"></span>
      <span class="timer-text">Koniec sesji za: <strong>{{ sessionEndTime }}</strong></span>
    </div>
    }
    
    <div class="font-controls">
      <button 
        class="font-btn"
        [class.active]="currentFontSize === 'small'"
        (click)="setFontSize('small')"
        aria-label="Small font">
        A
      </button>
      <button 
        class="font-btn font-medium"
        [class.active]="currentFontSize === 'medium'"
        (click)="setFontSize('medium')"
        aria-label="Medium font">
        A
      </button>
      <button 
        class="font-btn font-large"
        [class.active]="currentFontSize === 'large'"
        (click)="setFontSize('large')"
        aria-label="Large font">
        A
      </button>
    </div>
    
    <button 
      class="contrast-toggle"
      [class.active]="highContrastMode"
      (click)="toggleContrast()"
      aria-label="Toggle high contrast">
      <span class="contrast-icon icon-contrast"></span>
    </button>
    
    <button 
      class="dark-mode-toggle"
      [class.active]="darkMode"
      (click)="toggleDarkMode()"
      aria-label="Toggle dark mode">
      <span class="dark-mode-icon" [ngClass]="darkMode ? 'icon-sun' : 'icon-moon'"></span>
    </button>
    
    @if (!isAuthRoute()) {
    <div class="user-info">
      <span class="user-name">{{ userName }}</span>
      <span class="user-separator">|</span>
      <span class="user-role">{{ userRole }}</span>
    </div>
    
    <button class="logout-btn" (click)="logout()" aria-label="Logout">
      Wyloguj
    </button>
    }
  </div>
</header>

<!-- Main Layout - Only show when NOT on auth routes -->
@if (!isAuthRoute()) {

<!-- Main Layout -->
<div class="app-layout" [class.menu-collapsed]="!menuOpen">
  <!-- Sidebar Navigation -->
  <aside class="app-sidebar" [class.collapsed]="!menuOpen">
    <div class="sidebar-header">
      <span class="sidebar-title">MENU</span>
    </div>
    
    <nav class="sidebar-nav">
      <a 
        *ngFor="let item of menuItems"
        [routerLink]="item.route"
        routerLinkActive="active"
        class="nav-item"
        [attr.data-tooltip]="item.label"
        [class.has-tooltip]="!menuOpen">
        <span class="nav-icon" [ngClass]="item.iconClass"></span>
        <span class="nav-label" *ngIf="menuOpen">{{ item.label }}</span>
      </a>
    </nav>
    
    <!-- Accessibility Controls (Mobile) -->
    <div class="sidebar-accessibility" *ngIf="menuOpen">
      <button 
        class="accessibility-toggle" 
        (click)="toggleAccessibilitySection()"
        aria-label="Toggle accessibility settings">
        <span class="toggle-icon" [class.expanded]="accessibilitySectionOpen">▼</span>
        <span class="toggle-label">Ustawienia dostępności</span>
      </button>
      
      <div class="accessibility-content" [class.open]="accessibilitySectionOpen">
        <div class="accessibility-section">
          <label class="accessibility-label">Rozmiar czcionki:</label>
          <div class="font-controls">
            <button 
              class="font-btn"
              [class.active]="currentFontSize === 'small'"
              (click)="setFontSize('small')"
              aria-label="Small font">
              A
            </button>
            <button 
              class="font-btn font-medium"
              [class.active]="currentFontSize === 'medium'"
              (click)="setFontSize('medium')"
              aria-label="Medium font">
              A
            </button>
            <button 
              class="font-btn font-large"
              [class.active]="currentFontSize === 'large'"
              (click)="setFontSize('large')"
              aria-label="Large font">
              A
            </button>
          </div>
        </div>
        
        <div class="accessibility-section">
          <label class="accessibility-label">Wygląd:</label>
          <div class="appearance-controls">
            <button 
              class="contrast-toggle"
              [class.active]="highContrastMode"
              (click)="toggleContrast()"
              aria-label="Toggle high contrast">
              <span class="contrast-icon icon-contrast"></span>
              <span class="control-label">Wysoki kontrast</span>
            </button>
            
            <button 
              class="dark-mode-toggle"
              [class.active]="darkMode"
              (click)="toggleDarkMode()"
              aria-label="Toggle dark mode">
              <span class="dark-mode-icon" [ngClass]="darkMode ? 'icon-sun' : 'icon-moon'"></span>
              <span class="control-label">Tryb ciemny</span>
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="sidebar-footer" *ngIf="menuOpen">
      <button class="collapse-btn" (click)="toggleMenu()">
        Zwiń menu
      </button>
    </div>
  </aside>
  
  <!-- Main Content -->
  <main class="app-content">
    <router-outlet />
  </main>
</div>
<!-- End of app-layout -->
}
<!-- End of !isAuthRoute() conditional -->

<!-- Auth Routes - Fullscreen without layout -->
@if (isAuthRoute()) {
  <router-outlet />
}
